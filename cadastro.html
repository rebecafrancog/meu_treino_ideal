<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - Meu Treino Ideal</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="shortcut icon" type="icone" href="img/Logo.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body class="auth-page">
    <div class="auth-container signup-container">
        <button class="btn btn-dark btn-back btn-animated" onclick="window.location.href='index.html'">
            <svg class="icon-small" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Voltar
        </button>

        <div class="auth-card signup-card">
            <div class="auth-header">
                <div class="auth-icon-wrapper">
                    <img src="img/Logosaude.png" alt="Logo" width="40" height="35">
                </div>
                <h1 class="auth-title">Crie sua conta</h1>
                <p class="auth-description">Preencha seus dados e comece sua jornada esportiva</p>
            </div>

            <form id="signupForm" class="auth-form">
                <div class="form-section">
                    <h3 class="form-section-title">Dados Pessoais</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="name" class="form-label">Nome Completo *</label>
                            <input type="text" id="name" class="form-input" placeholder="Seu nome completo" required>
                        </div>
                        <div class="form-group">
                            <label for="username" class="form-label">Nome de Usuário *</label>
                            <input type="text" id="username" class="form-input" placeholder="usuario123" required>
                        </div>
                        <div class="form-group">
                            <label for="cpf" class="form-label">CPF *</label>
                            <input type="text" id="cpf" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
                        </div>
                        <div class="form-group">
                            <label for="gender" class="form-label">Gênero *</label>
                            <select id="gender" class="form-select" required>
                                <option value="">Selecione seu gênero</option>
                                <option value="masculino">Masculino</option>
                                <option value="feminino">Feminino</option>
                                <option value="outro">Outro</option>
                                <option value="prefiro-nao-informar">Prefiro não informar</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ageRange" class="form-label">Faixa Etária *</label>
                            <select id="ageRange" class="form-select" required>
                                <option value="">Selecione sua faixa etária</option>
                                <option value="13-17">13-17 anos</option>
                                <option value="18-25">18-25 anos</option>
                                <option value="26-35">26-35 anos</option>
                                <option value="36-45">36-45 anos</option>
                                <option value="46-55">46-55 anos</option>
                                <option value="56+">56+ anos</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="form-section-title">Contato</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="email" class="form-label">Email *</label>
                            <input type="email" id="email" class="form-input" placeholder="seu@email.com" required>
                        </div>
                        <div class="form-group">
                            <label for="phone" class="form-label">Telefone *</label>
                            <input type="text" id="phone" class="form-input" placeholder="(00) 00000-0000" maxlength="15" required>
                        </div>
                        <div class="form-group form-group-full">
                            <label for="password" class="form-label">Senha *</label>
                            <input type="password" id="password" class="form-input" placeholder="••••••••" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="form-section-title">Endereço</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="cep" class="form-label">CEP *</label>
                            <input type="text" id="cep" class="form-input" placeholder="00000-000" maxlength="9" required>
                        </div>
                        <div class="form-group">
                            <label for="address" class="form-label">Endereço *</label>
                            <input type="text" id="address" class="form-input" placeholder="Rua, número" required>
                        </div>
                        <div class="form-group">
                            <label for="city" class="form-label">Cidade *</label>
                            <input type="text" id="city" class="form-input" placeholder="Cidade" required>
                        </div>
                        <div class="form-group">
                            <label for="state" class="form-label">Estado *</label>
                            <input type="text" id="state" class="form-input" placeholder="UF" maxlength="2" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="form-section-title">Preferências Esportivas</h3>
                    <label class="form-label">Esportes que pratica/deseja praticar (selecione um ou mais) *</label>
                    <div class="sports-grid">
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Futebol">
                            <span>Futebol</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Basquete">
                            <span>Basquete</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Vôlei">
                            <span>Vôlei</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Natação">
                            <span>Natação</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Corrida">
                            <span>Corrida</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Ciclismo">
                            <span>Ciclismo</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Musculação">
                            <span>Musculação</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Tênis">
                            <span>Tênis</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Artes Marciais">
                            <span>Artes Marciais</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Yoga/Pilates">
                            <span>Yoga/Pilates</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="CrossFit">
                            <span>CrossFit</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Treino Funcional">
                            <span>Treino Funcional</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="sports" value="Outros">
                            <span>Pratica outro esporte?
                            Especifique abaixo.</span>
                        </label>
                        <textarea id="mensagem" name="mensagem" rows="4" cols="50"></textarea>
                    </div>
                </div>

                <div id="errorMessage" class="error-message" style="display: none;"></div>

                <button type="submit" class="btn btn-dark btn-animated">Criar Conta e Gerar Cronograma</button>

                <p class="auth-footer-text">
                    Já tem uma conta?
                    <a href="login.html" class="auth-link">Faça login</a>
                </p>
            </form>
        </div>
    </div>

    <script src="scripts.js"></script>
    <script>
        document.getElementById('cpf').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                e.target.value = value;
            }
        });

        document.getElementById('phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
                e.target.value = value;
            }
        });

        document.getElementById('cep').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 8) {
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
                e.target.value = value;
            }
        });

        document.getElementById('cep').addEventListener('blur', async function() {
            const cep = this.value.replace(/\D/g, '');
            if (cep.length === 8) {
                try {
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await response.json();
                    if (!data.erro) {
                        document.getElementById('address').value = data.logradouro || '';
                        document.getElementById('city').value = data.localidade || '';
                        document.getElementById('state').value = data.uf || '';
                    }
                } catch (error) {
                    console.error('Erro ao buscar CEP:', error);
                }
            }
        });

        document.getElementById('state').addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });

        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const errorMessage = document.getElementById('errorMessage');
            const sportsCheckboxes = document.querySelectorAll('input[name="sports"]:checked');
            const sports = Array.from(sportsCheckboxes).map(cb => cb.value);
            
            if (sports.length === 0) {
                errorMessage.textContent = 'Por favor, selecione pelo menos um esporte';
                errorMessage.style.display = 'block';
                window.scrollTo(0, 0);
                return;
            }

            const cpf = document.getElementById('cpf').value.replace(/\D/g, '');
            if (cpf.length !== 11) {
                errorMessage.textContent = 'Por favor, insira um CPF válido com 11 dígitos';
                errorMessage.style.display = 'block';
                window.scrollTo(0, 0);
                return;
            }

            const cep = document.getElementById('cep').value.replace(/\D/g, '');
            if (cep.length !== 8) {
                errorMessage.textContent = 'Por favor, insira um CEP válido com 8 dígitos';
                errorMessage.style.display = 'block';
                window.scrollTo(0, 0);
                return;
            }

            const user = {
                id: Date.now().toString(),
                name: document.getElementById('name').value,
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                cpf: document.getElementById('cpf').value,
                phone: document.getElementById('phone').value,
                gender: document.getElementById('gender').value,
                ageRange: document.getElementById('ageRange').value,
                cep: document.getElementById('cep').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                sports: sports,
                schedules: generateSchedule(sports)
            };

            const users = JSON.parse(localStorage.getItem('sportfitUsers') || '[]');

            if (users.some(u => u.email === user.email)) {
                errorMessage.textContent = 'Este email já está cadastrado. Faça login ou use outro email.';
                errorMessage.style.display = 'block';
                window.scrollTo(0, 0);
                return;
            }

            users.push(user);
            localStorage.setItem('sportfitUsers', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(user));

            window.location.href = 'dashboard.html';
        });
    </script>
</body>
</html>
